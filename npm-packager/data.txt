PACKAGES 

DOWNLOAD MANIFEST
DOWNLOAD TARBALL 
DECOMPRESS TARBALL 
COPY PACKAGE  IN NODE MODULES 


TODO 

[X] - fix lib version,  add struct , test
[X] - Use .config folder 
[X] - use package json
[X] - Cache tarball,  do  not download if file exits
[X] - if dependecies in package.json update 
[X] - add tests
[X] - read package-lock.json
[X] - Create package-go-lock.json 
[X] - when udate package.json and lock exists , update that too and install new package
[X] - when add package install a package that existist but with a diff version,  nested in node_modules
[ ] - Replace ETag when change 
[X] - Manage this kind of packages  .config/go-npm/packages/@types/triple-beam@1.3.5/package.json:
[ ] Run first downloadi n parallel
[ ] Fix tests 
[ ] - Manage dev dependecies
[X] - Remove tarball file after decompress
[] - update add command -install
[ ] - Manage conflig differe lib version of packages
[ ] - manifest download if new version exists   
[ ] - if package exists in config,  prevent download 
[ ] - Fix race condition downloas same pakcage name verions but for different parent package
[ ] - Creat tutorial


REMOVE PACKAGE 
Check if package exists in packge.json 
if exists check dependencies from lock file 
resolve which packages are safe to delete - first check without resolved
remove from node_modules 
update package.json and lock file


check in lock file 
dependicies for packakge 
check if other package depend on same parent nodule,  if true do not remove
check if parent package.json depend on that lib







	pm.Etag.setPackages(pm.processedPackages)
	if err := pm.Etag.save(); err != nil {
		return fmt.Errorf("failed to save etag data: %v", err)
	}

// if no package-lock exits
// read package json .
// Read manifest and get dependencies
// Create packgejsonlock struct and file package-lock.json



curl -H "If-None-Match: b8dd7dcd28522e9c7b03891e5602b80f" -I https://registry.npmjs.org/express

guardar etag en archivo.
enviar en peticion para manifest 

{
    "express": {
        "version": "4.17.1",
        "dependencies": [
            {
                "name": "body-parser",
                "version": "1.19.0"
                "nested": false,
            },
            {
                "name": "cookie-parser",
                "version": "1.4.4"
                "nested": false,
            }
        ]
    },
    "lodash": {
        "version": "4.17.21",
        "dependencies": [
            {
                "name": "lodash",
                "version": "4.17.21"
                "nested": false,
            },
            {
                "name": "cookie-parser",
                "version": "2.0.0"
                "nested": true,
            }
        ]
    }

}




guardar etag relacionado a paquete,  


    {
        "express": {
            "etag": "b8dd7dcd28522e9c7b03891e5602b80f"
        },

        "lodash": {
            "etag": "b8dd7dcd28522e9c7b03891e5602b80f"
        }
    }

